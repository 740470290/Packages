window.$=(function () {
  const f = 'http://192.168.2.118:9000';// 配置全局地址,适用于多页面网站,ajax.url适用于单页网站
  return {
    url:f,
    get: function (u, d, c) {
      let x = new XMLHttpRequest();
      if(c){
        u +='?';
        for (let i in d) {
          u += i + '=' + d[i] + '&'
        }
      }
      u=u.slice(0,-1)
      x.open('GET', this.url + u, true);
      // x.withCredentials = true; // 配置是否发送cookie
      x.send();
      x.onreadystatechange = function () {
        if (x.readyState === 4) {
          c?c(JSON.parse(x.response)):d(JSON.parse(x.response));
          x = null
        }
      }
    },
    post: function (u, d, c) {
      let x = new XMLHttpRequest();
      x.open('POST', this.url + u, true);
      if(!d.innerHTML){
        x.setRequestHeader('content-type', 'application/x-www-form-urlencoded');
      let s = '';
      for (let i in d) {
        s += i + '=' + d[i] + '&'
      }
      s=s.slice(0,-1)
      x.send(s);
      }else{
        const form = new FormData(d);
        x.send(form);
      }
      x.onreadystatechange = function () {
        if (x.readyState === 4 && x.status === 200) {
          c(JSON.parse(x.response));
          x = null
        }
      }
    },
    jsonp: function (u, c) {
      const n = 'jsonp' + Math.random().toString().slice(2);
      const s = document.createElement('script');
      const h = document.head;
      s.src = u + (u.includes('?') ? '&' : '?') + 'callback=' + n;
      h.appendChild(s);
      window[n] = function (r) {
        c(r);
        delete window[n];
        h.removeChild(s)
      }
    },
    mouseMove: function (obj) {
      document.body.style.overflowX='hidden';
      var mouseDownX,mouseDownY,initX,initY,flag = false;
      obj.onmousedown = function(e) {
          //鼠标按下时的鼠标所在的X，Y坐标
          mouseDownX = e.pageX;
          mouseDownY = e.pageY;
          //初始位置的X，Y 坐标
          initX = obj.offsetLeft;
          initY = obj.offsetTop;
          //表示鼠标已按下
          flag = true;
      };
      obj.onmousemove = function(e) {
          if(flag) {
              var mouseMoveX = e.pageX,mouseMoveY = e.pageY;
              this.style.left = mouseMoveX - mouseDownX + initX + "px";
              this.style.top = mouseMoveY - mouseDownY + initY + "px";
          }
      };
      obj.onmouseup = function() {
          flag = false;
      };
      obj.onmouseout = function() {
          flag = false;
      }
    }
  }
})();
